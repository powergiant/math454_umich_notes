\section{Introduction and preliminaries}

\subsection{Definitions of partial differential equations}

\begin{definition}[Notations of partial derivatives]
For $f(x)$ with one variable $x$, we know $f^{\prime}(x)=\frac{d f}{d x}$. For $u(x, y)$, we introduce partial derivatives as
\begin{equation}\label{eq.1st_derivatives}
    \frac{\partial u}{\partial x}=\left.\frac{d u}{d x}\right|_{y \text { is fixed }}=\partial_x u=u_x .
\end{equation}
Similarly,
\begin{equation}\label{eq.2nd_derivatives}
    \frac{\partial^2 u}{\partial x^2}=\partial_x^2 u=\partial_{xx} u=u_{x x}
\end{equation}
\end{definition}

\begin{example}[]
For $u(x, y)=x y^2$, we have
\begin{equation*}
\frac{\partial u}{\partial x} = \partial_x u = u_x = y^2, \qquad \frac{\partial u}{\partial y} = \partial_y u = u_y = 2 x y,
\end{equation*}
\begin{equation*}
\frac{\partial^2 u}{\partial x^2}=\partial_x^2 u=\partial_{xx} u=u_{x x}=0, \qquad \frac{\partial^2 u}{\partial y^2}=\partial_y^2 u=\partial_{yy} u=u_{y y}=2 x
\end{equation*}

\end{example}

\begin{definition}[Definition of general PDEs]
    Given a function $u = u(x, y)$ of two variables, (similarly $u = u(x_1, \cdots, x_n)$ of $n$ variables) and an expression $F(u_{xx}, u_{xy}, u_{yy}, u_{x}, u_{y}, u, x, y)$ of partial derivatives of $u$, the following equation is a \underline{partial differential equation}, abbreviated as \underline{PDE}.
    \begin{equation}\label{eq.PDE_general}
        F(u_{xx}, u_{xy}, u_{yy}, u_{x}, u_{y}, u, x, y) = 0
    \end{equation}
    In the future, we may also use the notation $F[u]$ to represent $F(u_{xx}, u_{xy}, u_{yy}, u_{x}, u_{y}, u, x, y)$. And \eqref{eq.PDE_general} can be rewritten as 
    \begin{equation}\label{eq.PDE_general_short}
        F[u] = 0.
    \end{equation}
\end{definition}
\begin{remark}[]
    $F[u]$ may also involve derivatives of order $\ge 2$, but we do not discuss it in this course.
\end{remark}

\begin{example}[Examples of PDEs]
    Here are some examples of PDEs.
    \begin{equation}\label{eq.examples_PDE}
        \begin{split}
            &u_{x x}-u_y=0 \quad \text{(the heat equation)}
            \\
            &u_{x x}-u_{y y}=0 \quad \text{(the wave equation)}
            \\
            &u_{x x}+u_{y y}=0 \quad \text{(Laplace's equation)}
            \\
            &u_{x}+u_{y}=0 \quad \text{(the transport equation)}
            \\
            &u_{x}+uu_{y}=0 \quad \text{(the Burgers equation)}
        \end{split}
    \end{equation}
\end{example}

\begin{definition}[Order of PDEs]
    The \underline{order} of a PDE is the order of the highest-order derivative in the equation.
    In \eqref{eq.examples_PDE}, the first three PDEs are second order, and the last two are first order.
\end{definition}

\begin{definition}[Linear PDEs]
    Given a PDE $F[u] = 0$, if it satisfies 
    \begin{equation}\label{eq.linear_pde_def}
        F[u+v] = F[u] + F[v]\textit{ and }F[cu] = cF[u],
    \end{equation}
    then we say that $F[u] = 0$ is a \underline{linear PDE}. In \eqref{eq.examples_PDE}, the first four PDEs are linear, while the last one is not.
\end{definition}

We have the following proposition which characterizes all second order linear PDEs,

\begin{proposition}[]
The second-order linear PDEs can always be written as
\begin{equation}\label{eq.2nd_order_linear}
    a(x, y) u_{x x}+b(x, y) u_{x y}+c(x, y) u_{y y}+d(x, y) u_x+e(x, y) u_y+f(x, y) u=g(x, y),
\end{equation}
We assume $a^2+b^2+c^2 \neq 0$ for any $x$, $y$ (at least one of $a, b, c$ is nonzero). 
\end{proposition}
\begin{proof}
    This go beyond the scope of this course.
\end{proof}

\begin{definition}[]
    We call $a, b, c, d, e, f$ \underline{coefficients} and $g$ \underline{source term}. 
\end{definition}

\subsection{Classification of second-order PDEs}

In this course, we will mainly consider second-order linear PDEs.
\begin{equation}\label{eq.2nd_order_linear'}
    a(x, y) u_{x x}+b(x, y) u_{x y}+c(x, y) u_{y y}+d(x, y) u_x+e(x, y) u_y+f(x, y) u=g(x, y),
\end{equation}

These equations are classified as follows by the coefficients $a, b, c$.

\begin{definition}[Classification of PDEs] The second-order linear PDEs \eqref{eq.2nd_order_linear'} are classified as \underline{elliptic}, \underline{parabolic} and \underline{hyperbolic} by the following,
    \begin{equation}\label{eq.classification_PDE}
        \begin{cases}
            4 a c-b^2>0 & \text { elliptic } 
            \\ 
            4 a c-b^2=0 & \text { parabolic } 
            \\ 
            4 a c-b^2<0 & \text { hyperbolic }
        \end{cases}
    \end{equation}
where we note that $a, b, c$ are functions of $x, y$ and the inequalities in \eqref{eq.classification_PDE} is required to be true for any $x$, $y$.
\end{definition}


\subsection{Review of ODEs}

\begin{definition}[Separable ODEs]
    The following ODE is the \underline{separable} ODE
    \begin{equation}\label{eq.separable}
        y' + p(x)y = 0.
    \end{equation}
\end{definition}

\begin{theorem}[]\label{th.separable_ODE}
    Separable ODE can be solved in the following way
    \begin{equation*}
        y' + p(x)y = 0
        \quad\Rightarrow\quad \frac{dy}{dx} + p(x)y = 0 \quad\Rightarrow\quad \frac{dy}{y} = - p(x)dx
        \quad\Rightarrow\quad
        \int \frac{dy}{y} = - \int p(x)dx
    \end{equation*}
    and the solution is 
    \begin{equation}\label{eq.sol_separable}
        y(x) = Ce^{-\int p(x)dx}
    \end{equation}
\end{theorem}
\begin{proof}
    There is nothing to prove.
\end{proof}

\begin{example}[]
    Let us solve the following ODEs
    \begin{equation*}
        y^{\prime} = -6 x y
    \end{equation*}

    Apply the procedure in Theorem \ref{th.separable_ODE}
    \begin{equation*}
        y' = -6 x y
        \quad\Rightarrow\quad \frac{dy}{y} = -6 x dx
        \quad\Rightarrow\quad
        \int \frac{dy}{y} = - \int 6 x dx
        \quad\Rightarrow\quad
        \ln |y|=-3 x^2+C^{\prime}
    \end{equation*}
    Therefore, the solution is 
    \begin{equation*}
        y=C e^{-3 x^2}.
    \end{equation*}
    where $C(= \pm e^{C^{\prime}})$ is an arbitrary constant.
\end{example}

\begin{definition}[Linear ODEs]
    The following ODE is the \underline{linear} ODE
    \begin{equation}\label{eq.linear}
        y' + p(x)y = q(x).
    \end{equation}
\end{definition}

\begin{theorem}[]\label{th.linear_ODE}
    Linear ODE can be solved by the following procedure
    \begin{enumerate}
        \item Solve the corresponding separable equation $y' - p(x)y = 0$ to obtain a solution $\hat{y} = e^{\int p(x)dx}$.
        \item Multiply the linear ODE by $\hat{y}$ and rewrite the ODE
        \begin{equation*}
            y' + p(x)y = q(x)
            \quad\Rightarrow\quad 
            \hat{y}(y' + p(x)y) = \hat{y}q(x)
            \quad\Rightarrow\quad 
            (\hat{y}y)' = \hat{y}q(x)
        \end{equation*}
        \item Integrate the above equation 
        \begin{equation*}
            \begin{split}
                &\hat{y}y = \int \hat{y}q(x) dx + C
                \quad\Rightarrow\quad 
                y = \frac{1}{\hat{y}}\left(\int \hat{y}q(x) dx +  C\right)
                \\
                &
                \quad \Rightarrow \quad
                y = e^{-\int p(x)dx}\left(\int q(x)e^{\int p(x)dx} dx+C\right)
            \end{split}
        \end{equation*}
    \end{enumerate}
\end{theorem}
\begin{proof}
    There is nothing to prove.
\end{proof}
\begin{remark}[]
    In (2), we applied the following equation
    \begin{equation*}
        (\hat{y}y)' = \hat{y}(y' + p(x)y) 
    \end{equation*} 
    which is a corollary of the Leibniz rule.
    \begin{equation*}
        (\hat{y}y)' = \hat{y}'y + \hat{y}y' = \hat{y}y' + p(x) \hat{y} y = \hat{y}(y' + p(x)y) 
    \end{equation*}
\end{remark}

\begin{example}[]
    $(x^2+1) y^{\prime}+3 x y=6 x$, $y(0)=3$ is solved as $y(x)=2+(x^2+1)^{-3 / 2}$ by the procedure in Theorem \ref{th.linear_ODE}.

    To apply Theorem \ref{th.linear_ODE}, we divide both sides by $(x^2+1)$.
    \begin{equation*}
        (x^2+1) y^{\prime}+3 x y=6x 
        \quad\Rightarrow\quad
        y^{\prime} + \frac{3 x}{x^2+1} y = \frac{6x}{x^2+1}
    \end{equation*}
    then we apply the three steps in  Theorem \ref{th.linear_ODE}.
    \begin{enumerate}
        \item Solve the corresponding separable equation $y' - \frac{3 x}{x^2+1}y = 0$ to obtain a solution $(x^2+1)^{\frac{3}{2}}$.
        \item Multiply the linear ODE by $(x^2+1)^{\frac{3}{2}}$ and rewrite the ODE
        \begin{equation*}
            y^{\prime} + \frac{3 x}{x^2+1} y = \frac{6x}{x^2+1} 
            \quad\Rightarrow\quad
            ((x^2+1)^{\frac{3}{2}}y)' = 6x(x^2+1)^{\frac{1}{2}}
        \end{equation*}
        \item Integrate the above equation
        \begin{equation*}
            \begin{split}
                ((x^2+1)^{\frac{3}{2}}y)' = 6x(x^2+1)^{\frac{1}{2}}
                \quad&\Rightarrow\quad
                y = (x^2+1)^{-\frac{3}{2}} \left(\int 6x(x^2+1)^{\frac{1}{2}}+ C\right)
                \\
                &\Rightarrow\quad
                y = 2 + C(x^2+1)^{-\frac{3}{2}}
            \end{split} 
        \end{equation*}
    \end{enumerate}

We note that the solutions with undetermined constant $C$ are called \underline{general solutions}. Finally, we apply the initial condition $y(0)=3$ to obtain $C = 1$, so the solution of the initial value problem is 
\begin{equation*}
    y = 2 + (x^2+1)^{-\frac{3}{2}}.
\end{equation*}
\end{example}

\begin{definition}[Second order ODEs]
    The \underline{constant coefficient second order ODEs} are the following equations
    \begin{equation}\label{eq.2nd_ODE}
        a y^{\prime \prime}+b y^{\prime}+c y=0\ (a \neq 0) .
    \end{equation}
\end{definition}

\begin{theorem}[]\label{th.2nd_ODE}
    Constant coefficient second order ODEs can be solved by the following procedure
    \begin{enumerate}
        \item Solve the \underline{characteristic equation} $a\lambda^2 +  b\lambda + c = 0$ to get two solutions $\lambda_1$ and $\lambda_2$.
        \item If $\lambda_1\neq\lambda_2$, the general solution is 
        \begin{equation}\label{eq.sol_2nd_ode}
            y(x)=C_1 e^{\lambda_1 x}+C_2 e^{\lambda_2 x}
        \end{equation}
        \item If $\lambda_1=\lambda_2=\lambda$, the general solution is 
        \begin{equation}\label{eq.sol_2nd_ode_eqroot}
            y(x)=(C_1 + C_2x) e^{\lambda x}
        \end{equation}
        \item If $\lambda_1, \lambda_2$ are complex roots $\alpha \pm i\beta$, apply the Euler's formula to rewrite \eqref{eq.sol_2nd_ode}
        \begin{equation}\label{eq.sol_2nd_ode_complex}
            y(x)=C_1 e^{(\alpha+i \beta) x}+C_2 e^{(\alpha-i \beta) x}=e^{\alpha x}\left(c_1 \cos \beta x+c_2 \sin \beta x\right)
        \end{equation}
        where $c_1=C_1+C_2$, $c_2=i(C_1-C_2)$.
    \end{enumerate}
\end{theorem}
\begin{proof}
    This was explained in your ODE course.
\end{proof}

\begin{example}[]
    $y'' - 3y' + 2y = 0$ is solved as $y(x)=C_1e^{x}+C_2e^{2x}$ by the procedure in Theorem \ref{th.2nd_ODE}.
    \begin{enumerate}
        \item Solve the characteristic equation $\lambda^2 - 3\lambda + 2 = 0$ to get two solutions $\lambda_1 = 1$ and $\lambda_2 = 2$.
        \item Since $\lambda_1\neq\lambda_2$, by \eqref{eq.sol_2nd_ode}, the general solution is 
        \begin{equation}
            y(x)=C_1 e^{x}+C_2 e^{2x}
        \end{equation}
    \end{enumerate}
\end{example}

\begin{example}[]
    $y'' + y = 0$ is solved as $y(x)=C_1\cos(x)+C_2\sin(x)$ by the procedure in Theorem \ref{th.2nd_ODE}.
    \begin{enumerate}
        \item Solve the characteristic equation $\lambda^2 + 1 = 0$ to get two solutions $\lambda_1 = i$ and $\lambda_2 = -i$.
        \item Since $\lambda_1,\lambda_2$ are complex, by \eqref{eq.sol_2nd_ode_complex}, the general solution is 
        \begin{equation}
            y(x)=C_1 \cos x + C_2 \sin x
        \end{equation}
    \end{enumerate}
\end{example}

\begin{example}[]
    $y'' + 2y' + y = 0$ is solved as $y(x)=(C_1+C_2x)e^{-x}$ by the procedure in Theorem \ref{th.2nd_ODE}.
    \begin{enumerate}
        \item Solve the characteristic equation $\lambda^2 + 2\lambda + 1 = 0$ to get $\lambda_1 = \lambda_2 = -1$.
        \item Since $\lambda_1,\lambda_2$ are equal, by \eqref{eq.sol_2nd_ode_eqroot}, the general solution is 
        \begin{equation}
            y(x)=(C_1+C_2x)e^{-x}
        \end{equation}
    \end{enumerate}
\end{example}

% \subsection{Boundary value problem}
% \textbf{TODO: }

\subsection{Separation of variables}
Many linear PDEs can be reduced to linear ODEs with the method of separation of
variables, described below.

We take the Laplace's equation
\begin{equation}\label{eq.Laplace}
    u_{x x}+u_{y y}=0
\end{equation}
with boundary condition
\begin{equation}\label{eq.Laplace_boundary}
    u(0, y)=0, \quad u(L, y)=0, \quad u(x, 0)=0, \quad u(x, L)=\varphi(x).
\end{equation}
as an example.

\begin{figure}[H]
    \begin{tikzpicture}
        \node at (0,0) {\scalebox{0.5}{      
            \includegraphics{pictures/boundary_value_problem.png}
        }};
        \node at (2.1, -1.5) {$x$};
        \node at (-1.0, 2.1) {$y$};
        \node at (1.2, -1.5) {$L$};
        \node at (-1.5, 1.2) {$L$};
        \node at (0.0, 1.5) {$\varphi(x)$};
        \node at (0.0, -1.5) {$0$};
        \node at (1.5, -0.1) {$0$};
        \node at (-1.5, -0.1) {$0$};
        % \node at (-1, -1.1) {$O$};
    \end{tikzpicture}
    \centering 
    \caption{The boundary value problem.} 
    \label{fig.boundary_value_problem} 
\end{figure}

We are looking for a \underline{separated solution} of the form, $u(x, y) = X(x) Y(y)$. Substitute into \eqref{eq.Laplace}, then we get 
\begin{equation*}
    X^{\prime \prime} Y+X Y^{\prime \prime}=0 \quad\Rightarrow\quad
    \frac{X^{\prime \prime}}{X}= -\frac{Y^{\prime \prime}}{Y}
\end{equation*}

The following lemma implies that $X''/X$ and $Y''/Y$ are constants.

\begin{lemma}[]\label{lem.separation_var}
    $f(x) = g(y)$ implies that $f(x) = g(y) = \textit{const}$,
\end{lemma}
\begin{proof}
    $f(x) = g(y)$ $\Rightarrow$ $f'(x) = \partial_x (g(y)) = 0$ $\Rightarrow$ $f(x) = \textit{const}$.
\end{proof}

Let $\lambda$ be the constant and we write
\begin{equation*}
    X^{\prime \prime}+\lambda X=0, \quad Y^{\prime \prime}-\lambda Y=0 .
\end{equation*}

We call $\lambda$ the \underline{separation constant}. At this moment $\lambda$ is arbitrary. Thus the PDE was reduced to two ODEs.

\subsubsection{Solving the boundary value problem}
The function $u(x, y)$ satisfies the following boundary conditions
\begin{equation}\label{eq.solve_boundary_value_1}
u(0, y)=0, \quad u(L, y)=0, \quad u(x, 0)=0, \quad u(x, L)=\varphi(x).
\end{equation}
Let us only consider the first three conditions.
\begin{equation}\label{eq.solve_boundary_value_2}
u(0, y)=0, \quad u(L, y)=0, \quad u(x, 0)=0.
\end{equation}

The first two boundary conditions $u(0, y) = u(L, y) = 0$ imply that $X(0)Y(y) = X(L)Y(y) = 0$. Since taking $Y(y) = 0$ would force the separated solution $u(x, y) = X(x)Y(y) = 0$, yielding only the trivial solution, we must have $X(0) = X(L) = 0$. Similarly, the condition $u(x, 0) = 0$ gives $Y(0) = 0$.

Combining these boundary conditions with the ODEs derived previously, we obtain the following boundary value problems:
\begin{equation}\label{eq.separated_ODE}
\left\{
\begin{aligned}
    &X'' + \lambda X = 0, \qquad X(0) = X(L) = 0,
    \\
    &Y'' - \lambda Y = 0, \qquad Y(0) = 0.
\end{aligned}
\right.
\end{equation}

To solve the boundary value problem, we distinguish 3 different cases $\lambda = 0$, $\lambda = - k^2 < 0$ and $\lambda = k^2 > 0$.


\paragraph{Case 1: $\lambda = 0$.} The $X$-equation becomes $X'' = 0$, so $X(x) = Ax + B$. The boundary conditions $X(0) = X(L) = 0$ force $A = B = 0$, giving only the trivial solution $X \equiv 0$.

\paragraph{Case 2: $\lambda = -k^2 < 0$.} The $X$-equation becomes $X'' - k^2 X = 0$, with general solution $X(x) = A\cosh(kx) + B\sinh(kx)$. From $X(0) = 0$ we get $A = 0$, and from $X(L) = 0$ we get $B\sinh(kL) = 0$. Since $k \neq 0$, $\sinh(kL) \neq 0$, so $B = 0$. Again only the trivial solution.

\paragraph{Case 3: $\lambda = k^2 > 0$.} The $X$-equation becomes $X'' + k^2 X = 0$, with general solution $X(x) = A\cos(kx) + B\sin(kx)$. From $X(0) = 0$ we get $A = 0$. From $X(L) = 0$ we get $B\sin(kL) = 0$. For a nontrivial solution we need $\sin(kL) = 0$, which gives $kL = n\pi$ for $n = 1, 2, \ldots$. Thus
\[
\lambda_n = \left(\frac{n\pi}{L}\right)^2, \qquad X_n(x) = \sin\frac{n\pi x}{L}, \quad n = 1, 2, \ldots.
\]

With $\lambda = \lambda_n$, the $Y$-equation becomes $Y'' - \left(\frac{n\pi}{L}\right)^2 Y = 0$. Let $\mu = \frac{n\pi}{L}$. The characteristic equation is $r^2 - \mu^2 = 0$, giving $r = \pm \mu$, so the general solution is $Y(y) = C_1 e^{\mu y} + C_2 e^{-\mu y}$. The condition $Y(0) = 0$ gives $C_1 + C_2 = 0$, i.e.\ $C_2 = -C_1$, so $Y(y) = C_1 \left(e^{\mu y} - e^{-\mu y}\right)$.
Recall that the \underline{hyperbolic sine} and \underline{hyperbolic cosine} functions are defined by
\[
\sinh(z) = \frac{e^z - e^{-z}}{2}, \qquad \cosh(z) = \frac{e^z + e^{-z}}{2}.
\]
Using this notation, we can write
\[
Y(y) = D\sinh\frac{n\pi y}{L}.
\]

Therefore, by $u(x, y) = X(x) Y(y)$, we obtain the following separated solutions of Laplace's equation.
\begin{equation}
u(x, y)=A \sin \frac{n \pi x}{L} \sinh \frac{n \pi y}{L}, \quad n=1,2, \ldots,
\end{equation}



\subsubsection{Matching with the last boundary condition}\label{sec.match_boundary}

Now we consider the last boundary condition $u(x, L)=\varphi(x)$ in \eqref{eq.solve_boundary_value_2}. For arbitrary $\varphi(x)$, our separated solution $A \sin \frac{n \pi x}{L} \sinh \frac{n \pi y}{L}$ cannot match with this boundary condition. However, we can use a linear combination of this separated solution to generate more solutions,
\begin{equation}\label{eq.linear_combination_sep}
u(x, y)=\sum_{n = 1}^{\infty} A_n \sin \frac{n \pi x}{L} \sinh \frac{n \pi y}{L}.
\end{equation}

To match with $u(x, L)=\varphi(x)$, we take $y = L$ in \eqref{eq.linear_combination_sep},
\begin{equation}\label{eq.match_boundary}
\varphi(x) = u(x, L)=\sum_{n = 1}^{\infty} A_n \sin \frac{n \pi x}{L} \sinh \frac{n \pi L}{L}.
\end{equation}

Therefore, we get 
\begin{equation}\label{eq.match_boundary_1}
\varphi(x) =\sum_{n = 1}^{\infty}  A_n \sinh n \pi \sin \frac{n \pi x}{L}.
\end{equation}

Then $A_n$ can be solved from the sine Fourier coefficients introduced in section \ref{sec.A_n_coef_sep}.

The result is 
\begin{equation}\label{eq.solve_A_n}
    A_n = \frac{2}{L\sinh n\pi}\int_{0}^{L}\varphi(x)\sin \frac{n \pi x}{L} dx
\end{equation}

Substitute into \eqref{eq.linear_combination_sep}, then we solve Laplace's equation \eqref{eq.Laplace} with boundary condition.

